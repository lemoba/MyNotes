<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ã€Šæ•°æ®åº“SQLå®æˆ˜ã€‹é¢˜è§£ | Ranen</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/rust.svg">
    <meta name="description" content="å¿ƒä¸­æ— å¥³äººï¼Œä»£ç è‡ªç„¶ç¥!">
    
    <link rel="preload" href="/assets/css/0.styles.3cd9c93a.css" as="style"><link rel="preload" href="/assets/js/app.d008bd4a.js" as="script"><link rel="preload" href="/assets/js/2.c3ba2a3e.js" as="script"><link rel="preload" href="/assets/js/31.602c3c3b.js" as="script"><link rel="prefetch" href="/assets/js/10.faa6bfce.js"><link rel="prefetch" href="/assets/js/11.f0fe1ca6.js"><link rel="prefetch" href="/assets/js/12.2151f8a5.js"><link rel="prefetch" href="/assets/js/13.a2fea5af.js"><link rel="prefetch" href="/assets/js/14.c6d4de2e.js"><link rel="prefetch" href="/assets/js/15.20e64797.js"><link rel="prefetch" href="/assets/js/16.f56f20f0.js"><link rel="prefetch" href="/assets/js/17.1e46af76.js"><link rel="prefetch" href="/assets/js/18.9ae7a6bb.js"><link rel="prefetch" href="/assets/js/19.c46b6498.js"><link rel="prefetch" href="/assets/js/20.cca40775.js"><link rel="prefetch" href="/assets/js/21.d3e5a7ba.js"><link rel="prefetch" href="/assets/js/22.602e0ae3.js"><link rel="prefetch" href="/assets/js/23.b6888b28.js"><link rel="prefetch" href="/assets/js/24.1d2df3b8.js"><link rel="prefetch" href="/assets/js/25.a5c6f894.js"><link rel="prefetch" href="/assets/js/26.b21010fb.js"><link rel="prefetch" href="/assets/js/27.76239055.js"><link rel="prefetch" href="/assets/js/28.76a7745f.js"><link rel="prefetch" href="/assets/js/29.19047bf9.js"><link rel="prefetch" href="/assets/js/3.0631ff25.js"><link rel="prefetch" href="/assets/js/30.3113b243.js"><link rel="prefetch" href="/assets/js/32.f8ed11bb.js"><link rel="prefetch" href="/assets/js/33.ab84d219.js"><link rel="prefetch" href="/assets/js/34.a076b5dd.js"><link rel="prefetch" href="/assets/js/35.62b57e22.js"><link rel="prefetch" href="/assets/js/36.fa3dfffc.js"><link rel="prefetch" href="/assets/js/37.75b06d9c.js"><link rel="prefetch" href="/assets/js/38.76de7bc7.js"><link rel="prefetch" href="/assets/js/39.e2bbb80e.js"><link rel="prefetch" href="/assets/js/4.fce9a1c8.js"><link rel="prefetch" href="/assets/js/40.308a9bab.js"><link rel="prefetch" href="/assets/js/41.abcbd411.js"><link rel="prefetch" href="/assets/js/42.851beb3b.js"><link rel="prefetch" href="/assets/js/43.4f78b213.js"><link rel="prefetch" href="/assets/js/44.a637b177.js"><link rel="prefetch" href="/assets/js/45.ab73dbaf.js"><link rel="prefetch" href="/assets/js/46.ca5c9dcf.js"><link rel="prefetch" href="/assets/js/47.1b703f6f.js"><link rel="prefetch" href="/assets/js/48.497d106b.js"><link rel="prefetch" href="/assets/js/49.aa947fd1.js"><link rel="prefetch" href="/assets/js/5.1afe1b42.js"><link rel="prefetch" href="/assets/js/50.1619450d.js"><link rel="prefetch" href="/assets/js/51.4a8bbb5e.js"><link rel="prefetch" href="/assets/js/52.13896369.js"><link rel="prefetch" href="/assets/js/53.c95dd6c1.js"><link rel="prefetch" href="/assets/js/54.e311182b.js"><link rel="prefetch" href="/assets/js/55.62d4600a.js"><link rel="prefetch" href="/assets/js/56.7b362db9.js"><link rel="prefetch" href="/assets/js/57.957660d2.js"><link rel="prefetch" href="/assets/js/58.d06655a2.js"><link rel="prefetch" href="/assets/js/59.b617420a.js"><link rel="prefetch" href="/assets/js/6.825b5dec.js"><link rel="prefetch" href="/assets/js/60.6d34ba53.js"><link rel="prefetch" href="/assets/js/61.798355d1.js"><link rel="prefetch" href="/assets/js/62.6927211f.js"><link rel="prefetch" href="/assets/js/63.18af289b.js"><link rel="prefetch" href="/assets/js/64.f0859c68.js"><link rel="prefetch" href="/assets/js/65.5d69faeb.js"><link rel="prefetch" href="/assets/js/66.56774680.js"><link rel="prefetch" href="/assets/js/67.ae3be620.js"><link rel="prefetch" href="/assets/js/68.62f4f62f.js"><link rel="prefetch" href="/assets/js/69.755abd99.js"><link rel="prefetch" href="/assets/js/7.5f2104e4.js"><link rel="prefetch" href="/assets/js/70.25fb9b3a.js"><link rel="prefetch" href="/assets/js/71.c47a9157.js"><link rel="prefetch" href="/assets/js/72.ecec8b88.js"><link rel="prefetch" href="/assets/js/73.219f23eb.js"><link rel="prefetch" href="/assets/js/74.44363d59.js"><link rel="prefetch" href="/assets/js/75.a82555da.js"><link rel="prefetch" href="/assets/js/76.f690a52c.js"><link rel="prefetch" href="/assets/js/8.a09537ae.js"><link rel="prefetch" href="/assets/js/9.3d642539.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3cd9c93a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/rust.svg" alt="Ranen" class="logo"> <span class="site-name can-hide">Ranen</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è®¡ç®—æœºåŸºç¡€" class="dropdown-title"><span class="title">è®¡ç®—æœºåŸºç¡€</span> <span class="arrow down"></span></button> <button type="button" aria-label="è®¡ç®—æœºåŸºç¡€" class="mobile-dropdown-title"><span class="title">è®¡ç®—æœºåŸºç¡€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">
  è®¡ç®—æœºç½‘ç»œ
</a></li><li class="dropdown-item"><!----> <a href="/data-struct/" class="nav-link">
  æ•°æ®ç»“æ„ä¸ç®—æ³•
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><span class="title">æ•°æ®åº“</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ•°æ®åº“" class="mobile-dropdown-title"><span class="title">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link router-link-active">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¾®æœåŠ¡" class="dropdown-title"><span class="title">å¾®æœåŠ¡</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¾®æœåŠ¡" class="mobile-dropdown-title"><span class="title">å¾®æœåŠ¡</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/micro-service/" class="nav-link">
  10å¤©å…¥é—¨å¾®æœåŠ¡
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸­é—´ä»¶" class="dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸­é—´ä»¶" class="mobile-dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/middleware/mq/" class="nav-link">
  æ¶ˆæ¯ä¸­é—´ä»¶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç¨‹è¯­è¨€" class="dropdown-title"><span class="title">ç¼–ç¨‹è¯­è¨€</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç¨‹è¯­è¨€" class="mobile-dropdown-title"><span class="title">ç¼–ç¨‹è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php/" class="nav-link">
  PHP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶ä»–å·¥å…·" class="dropdown-title"><span class="title">å…¶ä»–å·¥å…·</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…¶ä»–å·¥å…·" class="mobile-dropdown-title"><span class="title">å…¶ä»–å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><a href="/book/" class="nav-link">
  ä¹¦ç±ğŸ“š
</a></div> <a href="https://github.com/lemoba/lemoba.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è®¡ç®—æœºåŸºç¡€" class="dropdown-title"><span class="title">è®¡ç®—æœºåŸºç¡€</span> <span class="arrow down"></span></button> <button type="button" aria-label="è®¡ç®—æœºåŸºç¡€" class="mobile-dropdown-title"><span class="title">è®¡ç®—æœºåŸºç¡€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">
  è®¡ç®—æœºç½‘ç»œ
</a></li><li class="dropdown-item"><!----> <a href="/data-struct/" class="nav-link">
  æ•°æ®ç»“æ„ä¸ç®—æ³•
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><span class="title">æ•°æ®åº“</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ•°æ®åº“" class="mobile-dropdown-title"><span class="title">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link router-link-active">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¾®æœåŠ¡" class="dropdown-title"><span class="title">å¾®æœåŠ¡</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¾®æœåŠ¡" class="mobile-dropdown-title"><span class="title">å¾®æœåŠ¡</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/micro-service/" class="nav-link">
  10å¤©å…¥é—¨å¾®æœåŠ¡
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸­é—´ä»¶" class="dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸­é—´ä»¶" class="mobile-dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/middleware/mq/" class="nav-link">
  æ¶ˆæ¯ä¸­é—´ä»¶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç¨‹è¯­è¨€" class="dropdown-title"><span class="title">ç¼–ç¨‹è¯­è¨€</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç¨‹è¯­è¨€" class="mobile-dropdown-title"><span class="title">ç¼–ç¨‹è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/php/" class="nav-link">
  PHP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶ä»–å·¥å…·" class="dropdown-title"><span class="title">å…¶ä»–å·¥å…·</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…¶ä»–å·¥å…·" class="mobile-dropdown-title"><span class="title">å…¶ä»–å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><a href="/book/" class="nav-link">
  ä¹¦ç±ğŸ“š
</a></div> <a href="https://github.com/lemoba/lemoba.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MySQL45è®²</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/mysql-45/1-sql-execute.html" class="sidebar-link">SQLæ˜¯å¦‚ä½•æ‰§è¡Œçš„</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MySQL</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ã€Šæ•°æ®åº“sqlå®æˆ˜ã€‹é¢˜è§£"><a href="#ã€Šæ•°æ®åº“sqlå®æˆ˜ã€‹é¢˜è§£" class="header-anchor">#</a> ã€Šæ•°æ®åº“SQLå®æˆ˜ã€‹é¢˜è§£</h2> <blockquote><p>æœ¬ä¸“é¢˜ä¸ºæ•°æ®åº“SQLå®æˆ˜ï¼Œæ¯é“é¢˜å‡ä¸ºç‰›å®¢ç²¾é€‰ï¼ŒåŒæ—¶æ¯é“é¢˜å‡æœ‰è€ƒè¯•æ¨¡å¼å’Œç»ƒä¹ æ¨¡å¼ï¼Œå¯åˆ‡æ¢ç»ƒä¹ ï¼Œæ”¯æŒmysqlå’Œsqliteæ•°æ®åº“ã€‚åŒ…å«æ•°æ®åº“æŸ¥æ‰¾ã€å¢åŠ ã€åˆ é™¤ç­‰çŸ¥è¯†ç‚¹ï¼Œå¯æ ¹æ®éœ€æ±‚ç»ƒä¹ ã€‚</p> <p>ç›®æ¥æºï¼š<a href="https://www.nowcoder.com/ta/sql" target="_blank" rel="noopener noreferrer">ç‰›å®¢ç½‘<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="ğŸ˜‹-ç®€å•"><a href="#ğŸ˜‹-ç®€å•" class="header-anchor">#</a> ğŸ˜‹[ç®€å•]</h3> <h4 id="sql1-æŸ¥æ‰¾æœ€æ™šå…¥èŒå‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯"><a href="#sql1-æŸ¥æ‰¾æœ€æ™šå…¥èŒå‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯" class="header-anchor">#</a> SQL1. æŸ¥æ‰¾æœ€æ™šå…¥èŒå‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯</h4> <p><a href="https://www.nowcoder.com/practice/218ae58dfdcd4af195fff264e062138f?tpId=82&amp;tqId=29753&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">WHERE</span> hire_date <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">max</span><span class="token punctuation">(</span>hire_date<span class="token punctuation">)</span> <span class="token keyword">FROM</span> employees<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="sql2-æŸ¥æ‰¾å…¥èŒå‘˜å·¥æ—¶é—´æ’åå€’æ•°ç¬¬ä¸‰çš„å‘˜å·¥æ‰€æœ‰ä¿¡æ¯"><a href="#sql2-æŸ¥æ‰¾å…¥èŒå‘˜å·¥æ—¶é—´æ’åå€’æ•°ç¬¬ä¸‰çš„å‘˜å·¥æ‰€æœ‰ä¿¡æ¯" class="header-anchor">#</a> SQL2. æŸ¥æ‰¾å…¥èŒå‘˜å·¥æ—¶é—´æ’åå€’æ•°ç¬¬ä¸‰çš„å‘˜å·¥æ‰€æœ‰ä¿¡æ¯</h4> <p><a href="https://www.nowcoder.com/practice/ec1ca44c62c14ceb990c3c40def1ec6c?tpId=82&amp;tqId=29754&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> hire_date <span class="token keyword">DESC</span> <span class="token keyword">LIMIT</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="sql3-æŸ¥æ‰¾æ‰€æœ‰å·²ç»åˆ†é…éƒ¨é—¨çš„å‘˜å·¥çš„last-nameå’Œfirst-name"><a href="#sql3-æŸ¥æ‰¾æ‰€æœ‰å·²ç»åˆ†é…éƒ¨é—¨çš„å‘˜å·¥çš„last-nameå’Œfirst-name" class="header-anchor">#</a> SQL3. æŸ¥æ‰¾æ‰€æœ‰å·²ç»åˆ†é…éƒ¨é—¨çš„å‘˜å·¥çš„last_nameå’Œfirst_name</h4> <p><a href="https://www.nowcoder.com/practice/6d35b1cd593545ab985a68cd86f28671?tpId=82&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>dept_no
<span class="token keyword">FROM</span> employees <span class="token keyword">As</span> e
<span class="token keyword">JOIN</span> dept_emp <span class="token keyword">As</span> d
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> d<span class="token punctuation">.</span>emp_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql4-æŸ¥æ‰¾è–ªæ°´æ¶¨å¹…è¶…è¿‡15æ¬¡çš„å‘˜å·¥å·emp-noä»¥åŠå…¶å¯¹åº”çš„æ¶¨å¹…æ¬¡æ•°t"><a href="#sql4-æŸ¥æ‰¾è–ªæ°´æ¶¨å¹…è¶…è¿‡15æ¬¡çš„å‘˜å·¥å·emp-noä»¥åŠå…¶å¯¹åº”çš„æ¶¨å¹…æ¬¡æ•°t" class="header-anchor">#</a> SQL4. æŸ¥æ‰¾è–ªæ°´æ¶¨å¹…è¶…è¿‡15æ¬¡çš„å‘˜å·¥å·emp_noä»¥åŠå…¶å¯¹åº”çš„æ¶¨å¹…æ¬¡æ•°t</h4> <p><a href="https://www.nowcoder.com/practice/6d4a4cff1d58495182f536c548fee1ae?tpId=82&amp;tqId=29759&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_no<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> t
<span class="token keyword">FROM</span> salaries
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> emp_no
<span class="token keyword">HAVING</span> t <span class="token operator">&gt;</span> <span class="token number">15</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql5-æ‰¾å‡ºæ‰€æœ‰å‘˜å·¥å½“å‰å…·ä½“çš„è–ªæ°´salaryæƒ…å†µ"><a href="#sql5-æ‰¾å‡ºæ‰€æœ‰å‘˜å·¥å½“å‰å…·ä½“çš„è–ªæ°´salaryæƒ…å†µ" class="header-anchor">#</a> SQL5. æ‰¾å‡ºæ‰€æœ‰å‘˜å·¥å½“å‰å…·ä½“çš„è–ªæ°´salaryæƒ…å†µ</h4> <p><a href="https://www.nowcoder.com/practice/ae51e6d057c94f6d891735a48d1c2397?tpId=82&amp;tqId=29760&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> salary 
<span class="token keyword">FROM</span> salaries
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql6-è·å–æ‰€æœ‰émanagerçš„å‘˜å·¥emp-no"><a href="#sql6-è·å–æ‰€æœ‰émanagerçš„å‘˜å·¥emp-no" class="header-anchor">#</a> SQL6. è·å–æ‰€æœ‰émanagerçš„å‘˜å·¥emp_no</h4> <p><a href="https://www.nowcoder.com/practice/32c53d06443346f4a2f2ca733c19660c?tpId=82&amp;tqId=29762&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_no
<span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> emp_no
<span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> emp_no <span class="token keyword">FROM</span> dept_manager<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql7-æŸ¥æ‰¾employeesè¡¨æ‰€æœ‰emp-noä¸ºå¥‡æ•°"><a href="#sql7-æŸ¥æ‰¾employeesè¡¨æ‰€æœ‰emp-noä¸ºå¥‡æ•°" class="header-anchor">#</a> SQL7. æŸ¥æ‰¾employeesè¡¨æ‰€æœ‰emp_noä¸ºå¥‡æ•°</h4> <p><a href="https://www.nowcoder.com/practice/a32669eb1d1740e785f105fa22741d5c?tpId=82&amp;tqId=29767&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees
<span class="token keyword">WHERE</span> emp_no<span class="token operator">&amp;</span><span class="token number">1</span> <span class="token operator">AND</span> last_name <span class="token operator">!=</span> <span class="token string">'Mary'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> hire_date <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql8-è·å–å½“å‰è–ªæ°´ç¬¬äºŒå¤šçš„å‘˜å·¥çš„emp-noä»¥åŠå…¶å¯¹åº”çš„è–ªæ°´salary"><a href="#sql8-è·å–å½“å‰è–ªæ°´ç¬¬äºŒå¤šçš„å‘˜å·¥çš„emp-noä»¥åŠå…¶å¯¹åº”çš„è–ªæ°´salary" class="header-anchor">#</a> SQL8. è·å–å½“å‰è–ªæ°´ç¬¬äºŒå¤šçš„å‘˜å·¥çš„emp_noä»¥åŠå…¶å¯¹åº”çš„è–ªæ°´salary</h4> <p><a href="https://www.nowcoder.com/practice/8d2c290cc4e24403b98ca82ce45d04db?tpId=82&amp;tqId=29769&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_no<span class="token punctuation">,</span> salary
<span class="token keyword">FROM</span> salaries
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql9-å°†employeesè¡¨çš„æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameæ‹¼æ¥èµ·æ¥ä½œä¸ºname-ä¸­é—´ä»¥ä¸€ä¸ªç©ºæ ¼åŒºåˆ†"><a href="#sql9-å°†employeesè¡¨çš„æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameæ‹¼æ¥èµ·æ¥ä½œä¸ºname-ä¸­é—´ä»¥ä¸€ä¸ªç©ºæ ¼åŒºåˆ†" class="header-anchor">#</a> SQL9. å°†employeesè¡¨çš„æ‰€æœ‰å‘˜å·¥çš„last_nameå’Œfirst_nameæ‹¼æ¥èµ·æ¥ä½œä¸ºNameï¼Œä¸­é—´ä»¥ä¸€ä¸ªç©ºæ ¼åŒºåˆ†</h4> <p><a href="https://www.nowcoder.com/practice/6744b90bbdde40209f8ecaac0b0516fe?tpId=82&amp;tqId=29800&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> concat_ws<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> first_name<span class="token punctuation">)</span> 
<span class="token keyword">AS</span> NAME
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql10-æ‰¹é‡æ’å…¥æ•°æ®"><a href="#sql10-æ‰¹é‡æ’å…¥æ•°æ®" class="header-anchor">#</a> SQL10.  æ‰¹é‡æ’å…¥æ•°æ®</h4> <p><a href="https://www.nowcoder.com/practice/51c12cea6a97468da149c04b7ecf362e?tpId=82&amp;tqId=29802&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> actor<span class="token punctuation">(</span>actor_id<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> last_update<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'PENELOPE'</span><span class="token punctuation">,</span> <span class="token string">'GUINESS'</span><span class="token punctuation">,</span> <span class="token string">'2006-02-15 12:34:33'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'NICK'</span><span class="token punctuation">,</span> <span class="token string">'WAHLBERG'</span><span class="token punctuation">,</span> <span class="token string">'2006-02-15 12:34:33'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql11-åˆ é™¤emp-noé‡å¤çš„è®°å½•-åªä¿ç•™æœ€å°çš„idå¯¹åº”çš„è®°å½•"><a href="#sql11-åˆ é™¤emp-noé‡å¤çš„è®°å½•-åªä¿ç•™æœ€å°çš„idå¯¹åº”çš„è®°å½•" class="header-anchor">#</a> SQL11.  åˆ é™¤emp_noé‡å¤çš„è®°å½•,åªä¿ç•™æœ€å°çš„idå¯¹åº”çš„è®°å½•</h4> <p><a href="https://www.nowcoder.com/practice/3d92551a6f6d4f1ebde272d20872cf05?tpId=82&amp;tqId=29810&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> titles_test
<span class="token keyword">WHERE</span> id <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
        <span class="token keyword">FROM</span> titles_test
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> emp_no
<span class="token punctuation">)</span> <span class="token keyword">AS</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="sql12-å°†æ‰€æœ‰to-dateä¸º9999-01-01çš„å…¨éƒ¨æ›´æ–°ä¸ºnull-ä¸”-from-dateæ›´æ–°ä¸º2001-01-01"><a href="#sql12-å°†æ‰€æœ‰to-dateä¸º9999-01-01çš„å…¨éƒ¨æ›´æ–°ä¸ºnull-ä¸”-from-dateæ›´æ–°ä¸º2001-01-01" class="header-anchor">#</a> SQL12.  å°†æ‰€æœ‰to_dateä¸º9999-01-01çš„å…¨éƒ¨æ›´æ–°ä¸ºNULL,ä¸” from_dateæ›´æ–°ä¸º2001-01-01</h4> <p><a href="https://www.nowcoder.com/practice/859f28f43496404886a77600ea68ef59?tpId=82&amp;tqId=29811&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> titles_test
<span class="token keyword">SET</span> to_date <span class="token operator">=</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> from_date <span class="token operator">=</span> <span class="token string">'2001-01-01'</span>
<span class="token keyword">WHERE</span> to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql13-å°†id-5ä»¥åŠemp-no-10001çš„è¡Œæ•°æ®æ›¿æ¢æˆid-5ä»¥åŠemp-no-10005-å…¶ä»–æ•°æ®ä¿æŒä¸å˜-ä½¿ç”¨replaceå®ç°"><a href="#sql13-å°†id-5ä»¥åŠemp-no-10001çš„è¡Œæ•°æ®æ›¿æ¢æˆid-5ä»¥åŠemp-no-10005-å…¶ä»–æ•°æ®ä¿æŒä¸å˜-ä½¿ç”¨replaceå®ç°" class="header-anchor">#</a> SQL13.  å°†id=5ä»¥åŠemp_no=10001çš„è¡Œæ•°æ®æ›¿æ¢æˆid=5ä»¥åŠemp_no=10005,å…¶ä»–æ•°æ®ä¿æŒä¸å˜ï¼Œä½¿ç”¨replaceå®ç°</h4> <p><a href="https://www.nowcoder.com/practice/2bec4d94f525458ca3d0ebf3bc8cd240?tpId=82&amp;tqId=29812&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> titles_test
<span class="token keyword">SET</span> emp_no <span class="token operator">=</span> <span class="token keyword">replace</span><span class="token punctuation">(</span>emp_no<span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">,</span> <span class="token number">10005</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql14-å°†titles-testè¡¨åä¿®æ”¹ä¸ºtitles-2017"><a href="#sql14-å°†titles-testè¡¨åä¿®æ”¹ä¸ºtitles-2017" class="header-anchor">#</a> SQL14.  å°†titles_testè¡¨åä¿®æ”¹ä¸ºtitles_2017</h4> <p><a href="https://www.nowcoder.com/practice/5277d7f92aa746ab8aa42886e5d570d4?tpId=82&amp;tqId=29813&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> titles_test <span class="token keyword">TO</span> titles_2017<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="sql15-å‡ºç°ä¸‰æ¬¡ä»¥ä¸Šç›¸åŒç§¯åˆ†çš„æƒ…å†µ"><a href="#sql15-å‡ºç°ä¸‰æ¬¡ä»¥ä¸Šç›¸åŒç§¯åˆ†çš„æƒ…å†µ" class="header-anchor">#</a> SQL15.  å‡ºç°ä¸‰æ¬¡ä»¥ä¸Šç›¸åŒç§¯åˆ†çš„æƒ…å†µ</h4> <p><a href="https://www.nowcoder.com/practice/c69ac94335744480aa50646864b7f24d?tpId=82&amp;tqId=35079&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> number 
<span class="token keyword">FROM</span> grade
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> number
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql16-æ‰¾åˆ°æ¯ä¸ªäººçš„ä»»åŠ¡"><a href="#sql16-æ‰¾åˆ°æ¯ä¸ªäººçš„ä»»åŠ¡" class="header-anchor">#</a> SQL16.  æ‰¾åˆ°æ¯ä¸ªäººçš„ä»»åŠ¡</h4> <p><a href="https://www.nowcoder.com/practice/9dd9182d029a4f1d8c1324b63fc719c9?tpId=82&amp;tqId=35081&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> p<span class="token punctuation">.</span>id<span class="token punctuation">,</span> p<span class="token punctuation">.</span>name<span class="token punctuation">,</span> t<span class="token punctuation">.</span>content
<span class="token keyword">FROM</span> task t
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> person p
<span class="token keyword">ON</span> p<span class="token punctuation">.</span>id <span class="token operator">=</span> t<span class="token punctuation">.</span>person_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> p<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="sql17-ç‰›å®¢æ¯ä¸ªäººæœ€è¿‘çš„ç™»å½•æ—¥æœŸ-ä¸€"><a href="#sql17-ç‰›å®¢æ¯ä¸ªäººæœ€è¿‘çš„ç™»å½•æ—¥æœŸ-ä¸€" class="header-anchor">#</a> SQL17.  ç‰›å®¢æ¯ä¸ªäººæœ€è¿‘çš„ç™»å½•æ—¥æœŸ(ä¸€)</h4> <p><a href="https://www.nowcoder.com/practice/ca274ebe6eac40ab9c33ced3f2223bb2?tpId=82&amp;tqId=35084&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> user_id<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">date</span><span class="token punctuation">)</span> <span class="token keyword">as</span> d
<span class="token keyword">FROM</span> login
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> user_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> user_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql18-è€ƒè¯•åˆ†æ•°-ä¸€"><a href="#sql18-è€ƒè¯•åˆ†æ•°-ä¸€" class="header-anchor">#</a> SQL18.  è€ƒè¯•åˆ†æ•°(ä¸€)</h4> <p><a href="https://www.nowcoder.com/practice/f41b94b4efce4b76b27dd36433abe398?tpId=82&amp;tqId=35492&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> job<span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">as</span> avg
<span class="token keyword">FROM</span> grade
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">avg</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">DESC</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="ğŸ˜œ-ä¸­ç­‰"><a href="#ğŸ˜œ-ä¸­ç­‰" class="header-anchor">#</a> ğŸ˜œ[ä¸­ç­‰]</h3> <h4 id="sql19-æŸ¥æ‰¾å„ä¸ªéƒ¨é—¨å½“å‰é¢†å¯¼å½“å‰è–ªæ°´è¯¦æƒ…ä»¥åŠå…¶å¯¹åº”éƒ¨é—¨ç¼–å·dept-no"><a href="#sql19-æŸ¥æ‰¾å„ä¸ªéƒ¨é—¨å½“å‰é¢†å¯¼å½“å‰è–ªæ°´è¯¦æƒ…ä»¥åŠå…¶å¯¹åº”éƒ¨é—¨ç¼–å·dept-no" class="header-anchor">#</a> SQL19.  æŸ¥æ‰¾å„ä¸ªéƒ¨é—¨å½“å‰é¢†å¯¼å½“å‰è–ªæ°´è¯¦æƒ…ä»¥åŠå…¶å¯¹åº”éƒ¨é—¨ç¼–å·dept_no</h4> <p><a href="https://www.nowcoder.com/practice/c63c5b54d86e4c6d880e4834bfd70c3b?tpId=82&amp;tqId=29755&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> s<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> d<span class="token punctuation">.</span>dept_no
<span class="token keyword">FROM</span> salaries <span class="token keyword">as</span> s
<span class="token keyword">JOIN</span> dept_manager <span class="token keyword">as</span> d
<span class="token keyword">ON</span> s<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> d<span class="token punctuation">.</span>emp_no
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>emp_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="sql20-æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameä»¥åŠå¯¹åº”éƒ¨é—¨ç¼–å·dept-no"><a href="#sql20-æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameä»¥åŠå¯¹åº”éƒ¨é—¨ç¼–å·dept-no" class="header-anchor">#</a> SQL20.  æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥çš„last_nameå’Œfirst_nameä»¥åŠå¯¹åº”éƒ¨é—¨ç¼–å·dept_no</h4> <p><a href="https://www.nowcoder.com/practice/dbfafafb2ee2482aa390645abd4463bf?tpId=82&amp;tqId=29757&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>dept_no
<span class="token keyword">FROM</span> employees <span class="token keyword">as</span> e
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> dept_emp <span class="token keyword">as</span> d
<span class="token keyword">ON</span> d<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> e<span class="token punctuation">.</span>emp_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql21-è·å–æ‰€æœ‰å‘˜å·¥å½“å‰çš„manager"><a href="#sql21-è·å–æ‰€æœ‰å‘˜å·¥å½“å‰çš„manager" class="header-anchor">#</a> SQL21.  è·å–æ‰€æœ‰å‘˜å·¥å½“å‰çš„manager</h4> <p><a href="https://www.nowcoder.com/practice/e50d92b8673a440ebdf3a517b5b37d62?tpId=82&amp;tqId=29763&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>emp_no<span class="token punctuation">,</span> m<span class="token punctuation">.</span>emp_no <span class="token keyword">as</span> manager
<span class="token keyword">FROM</span> dept_emp <span class="token keyword">as</span> e
<span class="token keyword">JOIN</span> dept_manager <span class="token keyword">as</span> m
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>dept_no <span class="token operator">=</span> m<span class="token punctuation">.</span>dept_no
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">&lt;&gt;</span> m<span class="token punctuation">.</span>emp_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="sql22-ç»Ÿè®¡å‡ºå½“å‰å„ä¸ªtitleç±»å‹å¯¹åº”çš„å‘˜å·¥å½“å‰è–ªæ°´å¯¹åº”çš„å¹³å‡å·¥èµ„"><a href="#sql22-ç»Ÿè®¡å‡ºå½“å‰å„ä¸ªtitleç±»å‹å¯¹åº”çš„å‘˜å·¥å½“å‰è–ªæ°´å¯¹åº”çš„å¹³å‡å·¥èµ„" class="header-anchor">#</a> SQL22.  ç»Ÿè®¡å‡ºå½“å‰å„ä¸ªtitleç±»å‹å¯¹åº”çš„å‘˜å·¥å½“å‰è–ªæ°´å¯¹åº”çš„å¹³å‡å·¥èµ„</h4> <p><a href="https://www.nowcoder.com/practice/c8652e9e5a354b879e2a244200f1eaae?tpId=82&amp;tqId=29768&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>salary<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> salaries <span class="token keyword">as</span> s
<span class="token keyword">JOIN</span> titles <span class="token keyword">as</span> t
<span class="token keyword">ON</span> t<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> s<span class="token punctuation">.</span>emp_no
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t<span class="token punctuation">.</span>title
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">avg</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="sql23-æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameä»¥åŠå¯¹åº”çš„dept-name"><a href="#sql23-æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameä»¥åŠå¯¹åº”çš„dept-name" class="header-anchor">#</a> SQL23.  æŸ¥æ‰¾æ‰€æœ‰å‘˜å·¥çš„last_nameå’Œfirst_nameä»¥åŠå¯¹åº”çš„dept_name</h4> <p><a href="https://www.nowcoder.com/practice/5a7975fabe1146329cee4f670c27ad55?tpId=82&amp;tqId=29771&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> d<span class="token punctuation">.</span>dept_name
<span class="token keyword">FROM</span> employees <span class="token keyword">as</span> e
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> dept_emp <span class="token keyword">as</span> de <span class="token keyword">ON</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> de<span class="token punctuation">.</span>emp_no
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> departments <span class="token keyword">as</span> d <span class="token keyword">ON</span> d<span class="token punctuation">.</span>dept_no <span class="token operator">=</span> de<span class="token punctuation">.</span>dept_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql24-ç»Ÿè®¡å„ä¸ªéƒ¨é—¨çš„å·¥èµ„è®°å½•æ•°"><a href="#sql24-ç»Ÿè®¡å„ä¸ªéƒ¨é—¨çš„å·¥èµ„è®°å½•æ•°" class="header-anchor">#</a> SQL24.  ç»Ÿè®¡å„ä¸ªéƒ¨é—¨çš„å·¥èµ„è®°å½•æ•°</h4> <p><a href="https://www.nowcoder.com/practice/6a62b6c0a7324350a6d9959fa7c21db3?tpId=82&amp;tqId=29774&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> d<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>salary<span class="token punctuation">)</span> <span class="token keyword">as</span> sum
<span class="token keyword">FROM</span> departments <span class="token keyword">as</span> d
<span class="token keyword">JOIN</span> dept_emp <span class="token keyword">as</span> de <span class="token keyword">ON</span> d<span class="token punctuation">.</span>dept_no <span class="token operator">=</span> de<span class="token punctuation">.</span>dept_no
<span class="token keyword">JOIN</span> salaries <span class="token keyword">as</span> s <span class="token keyword">ON</span> s<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> de<span class="token punctuation">.</span>emp_no
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> d<span class="token punctuation">.</span>dept_no
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> d<span class="token punctuation">.</span>dept_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="sql25-ä½¿ç”¨joinæŸ¥è¯¢æ–¹å¼æ‰¾å‡ºæ²¡æœ‰åˆ†ç±»çš„ç”µå½±idä»¥åŠåç§°"><a href="#sql25-ä½¿ç”¨joinæŸ¥è¯¢æ–¹å¼æ‰¾å‡ºæ²¡æœ‰åˆ†ç±»çš„ç”µå½±idä»¥åŠåç§°" class="header-anchor">#</a> SQL25.  ä½¿ç”¨joinæŸ¥è¯¢æ–¹å¼æ‰¾å‡ºæ²¡æœ‰åˆ†ç±»çš„ç”µå½±idä»¥åŠåç§°</h4> <p><a href="https://www.nowcoder.com/practice/a158fa6e79274ac497832697b4b83658?tpId=82&amp;tqId=29781&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> f<span class="token punctuation">.</span>film_id<span class="token punctuation">,</span> f<span class="token punctuation">.</span>title
<span class="token keyword">FROM</span> film <span class="token keyword">as</span> f
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> film_category <span class="token keyword">as</span> fc <span class="token keyword">ON</span> fc<span class="token punctuation">.</span>film_id <span class="token operator">=</span> f<span class="token punctuation">.</span>film_id
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> category <span class="token keyword">as</span> c <span class="token keyword">ON</span> c<span class="token punctuation">.</span>category_id <span class="token operator">=</span> fc<span class="token punctuation">.</span>category_id 
<span class="token keyword">WHERE</span> fc<span class="token punctuation">.</span>category_id <span class="token operator">is</span> <span class="token boolean">NULL</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="sql26-ä½¿ç”¨å­æŸ¥è¯¢çš„æ–¹å¼æ‰¾å‡ºå±äºactionåˆ†ç±»çš„æ‰€æœ‰ç”µå½±å¯¹åº”çš„title-description"><a href="#sql26-ä½¿ç”¨å­æŸ¥è¯¢çš„æ–¹å¼æ‰¾å‡ºå±äºactionåˆ†ç±»çš„æ‰€æœ‰ç”µå½±å¯¹åº”çš„title-description" class="header-anchor">#</a> SQL26.  ä½¿ç”¨å­æŸ¥è¯¢çš„æ–¹å¼æ‰¾å‡ºå±äºActionåˆ†ç±»çš„æ‰€æœ‰ç”µå½±å¯¹åº”çš„title,description</h4> <p><a href="https://www.nowcoder.com/practice/2f2e556d335d469f96b91b212c4c203e?tpId=82&amp;tqId=29782&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> f<span class="token punctuation">.</span>title<span class="token punctuation">,</span> f<span class="token punctuation">.</span>description
<span class="token keyword">FROM</span> film <span class="token keyword">as</span> f
<span class="token keyword">WHERE</span> f<span class="token punctuation">.</span>film_id <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> fc<span class="token punctuation">.</span>film_id 
    <span class="token keyword">FROM</span> film_category <span class="token keyword">AS</span> fc
    <span class="token keyword">WHERE</span> fc<span class="token punctuation">.</span>category_id <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> c<span class="token punctuation">.</span>category_id
        <span class="token keyword">FROM</span> category <span class="token keyword">as</span> c
        <span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Action'</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="sql27-åˆ›å»ºä¸€ä¸ªactorè¡¨-åŒ…å«å¦‚ä¸‹åˆ—ä¿¡æ¯"><a href="#sql27-åˆ›å»ºä¸€ä¸ªactorè¡¨-åŒ…å«å¦‚ä¸‹åˆ—ä¿¡æ¯" class="header-anchor">#</a> SQL27.  åˆ›å»ºä¸€ä¸ªactorè¡¨ï¼ŒåŒ…å«å¦‚ä¸‹åˆ—ä¿¡æ¯</h4> <p><a href="https://www.nowcoder.com/practice/ac233de508ef4849b0eeb4f38dcf09cf?tpId=82&amp;tqId=29801&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> actor <span class="token punctuation">(</span>
    action_id <span class="token keyword">smallint</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    first_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    last_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    last_update <span class="token keyword">date</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>
    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>action_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="sql28-æ‰¹é‡æ’å…¥æ•°æ®-å¦‚æœæ•°æ®å·²ç»å­˜åœ¨-è¯·å¿½ç•¥-ä¸ä½¿ç”¨replaceæ“ä½œ"><a href="#sql28-æ‰¹é‡æ’å…¥æ•°æ®-å¦‚æœæ•°æ®å·²ç»å­˜åœ¨-è¯·å¿½ç•¥-ä¸ä½¿ç”¨replaceæ“ä½œ" class="header-anchor">#</a> SQL28.  æ‰¹é‡æ’å…¥æ•°æ®,å¦‚æœæ•°æ®å·²ç»å­˜åœ¨ï¼Œè¯·å¿½ç•¥ï¼Œä¸ä½¿ç”¨replaceæ“ä½œ</h4> <p><a href="https://www.nowcoder.com/practice/153c8a8e7805400ba8e384e03acc6b3e?tpId=82&amp;tqId=29803&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">IGNORE</span> <span class="token keyword">INTO</span> actor <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'ED'</span><span class="token punctuation">,</span> <span class="token string">'CHASE'</span><span class="token punctuation">,</span> <span class="token string">'2006-02-15 12:34:33'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="sql29-åˆ›å»ºä¸€ä¸ªactor-nameè¡¨-å°†actorè¡¨ä¸­çš„æ‰€æœ‰first-nameä»¥åŠlast-nameå¯¼å…¥æ”¹è¡¨"><a href="#sql29-åˆ›å»ºä¸€ä¸ªactor-nameè¡¨-å°†actorè¡¨ä¸­çš„æ‰€æœ‰first-nameä»¥åŠlast-nameå¯¼å…¥æ”¹è¡¨" class="header-anchor">#</a> SQL29.  åˆ›å»ºä¸€ä¸ªactor_nameè¡¨ï¼Œå°†actorè¡¨ä¸­çš„æ‰€æœ‰first_nameä»¥åŠlast_nameå¯¼å…¥æ”¹è¡¨</h4> <p><a href="https://www.nowcoder.com/practice/881385f388cf4fe98b2ed9f8897846df?tpId=82&amp;tqId=29804&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> actor_name <span class="token punctuation">(</span>
    first_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    last_name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> actor_name 
<span class="token keyword">SELECT</span> first_name<span class="token punctuation">,</span> last_name
<span class="token keyword">FROM</span> actor<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="sql30-å¯¹first-nameåˆ›å»ºå”¯ä¸€ç´¢å¼•uniq-idx-firstname-å¯¹last-nameåˆ›å»ºæ™®é€šç´¢å¼•idx-lastname"><a href="#sql30-å¯¹first-nameåˆ›å»ºå”¯ä¸€ç´¢å¼•uniq-idx-firstname-å¯¹last-nameåˆ›å»ºæ™®é€šç´¢å¼•idx-lastname" class="header-anchor">#</a> SQL30. å¯¹first_nameåˆ›å»ºå”¯ä¸€ç´¢å¼•uniq_idx_firstnameï¼Œå¯¹last_nameåˆ›å»ºæ™®é€šç´¢å¼•idx_lastname</h4> <p><a href="https://www.nowcoder.com/practice/e1824daa0c49404aa602cf0cb34bdd75?tpId=82&amp;tqId=29805&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> uniq_idx_firstname <span class="token keyword">ON</span> actor<span class="token punctuation">(</span>first_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_lastname <span class="token keyword">ON</span> actor<span class="token punctuation">(</span>last_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="sql31-é’ˆå¯¹actorè¡¨åˆ›å»ºè§†å›¾actor-name-view"><a href="#sql31-é’ˆå¯¹actorè¡¨åˆ›å»ºè§†å›¾actor-name-view" class="header-anchor">#</a> SQL31. é’ˆå¯¹actorè¡¨åˆ›å»ºè§†å›¾actor_name_view</h4> <p><a href="https://www.nowcoder.com/practice/b9db784b5e3d488cbd30bd78fdb2a862?tpId=82&amp;tqId=29806&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> actor_name_view <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> first_name <span class="token keyword">AS</span> first_name_v<span class="token punctuation">,</span> last_name <span class="token keyword">AS</span> last_name_v
<span class="token keyword">FROM</span> actor<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql32-é’ˆå¯¹ä¸Šé¢çš„salariesè¡¨emp-noå­—æ®µåˆ›å»ºç´¢å¼•idx-emp-no-æŸ¥è¯¢emp-noä¸º10005"><a href="#sql32-é’ˆå¯¹ä¸Šé¢çš„salariesè¡¨emp-noå­—æ®µåˆ›å»ºç´¢å¼•idx-emp-no-æŸ¥è¯¢emp-noä¸º10005" class="header-anchor">#</a> SQL32. é’ˆå¯¹ä¸Šé¢çš„salariesè¡¨emp_noå­—æ®µåˆ›å»ºç´¢å¼•idx_emp_noï¼ŒæŸ¥è¯¢emp_noä¸º10005,</h4> <p><a href="https://www.nowcoder.com/practice/f9fa9dc1a1fc4130b08e26c22c7a1e5f?tpId=82&amp;tqId=29807&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> salaries 
<span class="token keyword">FORCE</span> <span class="token keyword">INDEX</span> <span class="token punctuation">(</span>idx_emp_no<span class="token punctuation">)</span> 
<span class="token keyword">WHERE</span> emp_no <span class="token operator">=</span> <span class="token number">10005</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql33-åœ¨last-updateåé¢æ–°å¢åŠ ä¸€åˆ—åå­—ä¸ºcreate-date"><a href="#sql33-åœ¨last-updateåé¢æ–°å¢åŠ ä¸€åˆ—åå­—ä¸ºcreate-date" class="header-anchor">#</a> SQL33. åœ¨last_updateåé¢æ–°å¢åŠ ä¸€åˆ—åå­—ä¸ºcreate_date</h4> <p><a href="https://www.nowcoder.com/practice/119f04716d284cb7a19fba65dd876b03?tpId=82&amp;tqId=29808&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> actor
<span class="token keyword">ADD</span> create_date <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">'2020-10-01 00:00:00'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="sql34-æ„é€ ä¸€ä¸ªè§¦å‘å™¨audit-log-åœ¨å‘employeesè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®çš„æ—¶å€™-è§¦å‘æ’å…¥ç›¸å…³çš„æ•°æ®åˆ°auditä¸­"><a href="#sql34-æ„é€ ä¸€ä¸ªè§¦å‘å™¨audit-log-åœ¨å‘employeesè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®çš„æ—¶å€™-è§¦å‘æ’å…¥ç›¸å…³çš„æ•°æ®åˆ°auditä¸­" class="header-anchor">#</a> SQL34. æ„é€ ä¸€ä¸ªè§¦å‘å™¨audit_logï¼Œåœ¨å‘employeesè¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œè§¦å‘æ’å…¥ç›¸å…³çš„æ•°æ®åˆ°auditä¸­</h4> <p><a href="https://www.nowcoder.com/practice/7e920bb2e1e74c4e83750f5c16033e2e?tpId=82&amp;tqId=29809&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> audit_log
<span class="token keyword">AFTER</span> <span class="token keyword">INSERT</span>
<span class="token keyword">ON</span> employees_test 
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> audit <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>new<span class="token punctuation">.</span>id<span class="token punctuation">,</span> new<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="sql35-åœ¨auditè¡¨ä¸Šåˆ›å»ºå¤–é”®çº¦æŸ-å…¶emp-noå¯¹åº”employees-testè¡¨çš„ä¸»é”®id"><a href="#sql35-åœ¨auditè¡¨ä¸Šåˆ›å»ºå¤–é”®çº¦æŸ-å…¶emp-noå¯¹åº”employees-testè¡¨çš„ä¸»é”®id" class="header-anchor">#</a> SQL35. åœ¨auditè¡¨ä¸Šåˆ›å»ºå¤–é”®çº¦æŸï¼Œå…¶emp_noå¯¹åº”employees_testè¡¨çš„ä¸»é”®id</h4> <p><a href="https://www.nowcoder.com/practice/aeaa116185f24f209ca4fa40e226de48?tpId=82&amp;tqId=29814&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> audit
<span class="token keyword">ADD</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>EMP_no<span class="token punctuation">)</span>
<span class="token keyword">REFERENCES</span> employees_test<span class="token punctuation">(</span>ID<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql36-å°†æ‰€æœ‰è·å–å¥–é‡‘çš„å‘˜å·¥å½“å‰çš„è–ªæ°´å¢åŠ 10"><a href="#sql36-å°†æ‰€æœ‰è·å–å¥–é‡‘çš„å‘˜å·¥å½“å‰çš„è–ªæ°´å¢åŠ 10" class="header-anchor">#</a> SQL36. å°†æ‰€æœ‰è·å–å¥–é‡‘çš„å‘˜å·¥å½“å‰çš„è–ªæ°´å¢åŠ 10%</h4> <p><a href="https://www.nowcoder.com/practice/d3b058dcc94147e09352eb76f93b3274?tpId=82&amp;tqId=29816&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> salaries <span class="token keyword">as</span> s
<span class="token keyword">SET</span> s<span class="token punctuation">.</span>salary <span class="token operator">=</span> s<span class="token punctuation">.</span>salary <span class="token operator">*</span> <span class="token number">1.1</span>
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>emp_no <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> emp_no 
    <span class="token keyword">FROM</span> emp_bonus
<span class="token punctuation">)</span> <span class="token operator">AND</span> s<span class="token punctuation">.</span>to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="sql37-å°†employeesè¡¨ä¸­çš„æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameé€šè¿‡"><a href="#sql37-å°†employeesè¡¨ä¸­çš„æ‰€æœ‰å‘˜å·¥çš„last-nameå’Œfirst-nameé€šè¿‡" class="header-anchor">#</a> SQL37. å°†employeesè¡¨ä¸­çš„æ‰€æœ‰å‘˜å·¥çš„last_nameå’Œfirst_nameé€šè¿‡(')</h4> <p><a href="https://www.nowcoder.com/practice/810bf4ee3ac64949b08983aa66ec7bee?tpId=82&amp;tqId=29818&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> concat<span class="token punctuation">(</span>last_name<span class="token punctuation">,</span> <span class="token string">''''</span><span class="token punctuation">,</span> first_name<span class="token punctuation">)</span> <span class="token keyword">as</span> name
<span class="token keyword">FROM</span> employees<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="sql38-æŸ¥æ‰¾å­—ç¬¦ä¸²-10-a-b"><a href="#sql38-æŸ¥æ‰¾å­—ç¬¦ä¸²-10-a-b" class="header-anchor">#</a> SQL38. æŸ¥æ‰¾å­—ç¬¦ä¸²'10,A,B'</h4> <p><a href="https://www.nowcoder.com/practice/e3870bd5d6744109a902db43c105bd50?tpId=82&amp;tqId=29819&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token punctuation">(</span>length<span class="token punctuation">(</span><span class="token string">&quot;10, A, B&quot;</span><span class="token punctuation">)</span> <span class="token operator">-</span> length<span class="token punctuation">(</span><span class="token keyword">REPLACE</span><span class="token punctuation">(</span><span class="token string">&quot;10, A, B&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="sql39-è·å–employeesä¸­çš„first-name-æŸ¥è¯¢æŒ‰ç…§first-nameæœ€åä¸¤ä¸ªå­—æ¯-æŒ‰ç…§å‡åºè¿›è¡Œæ’åˆ—"><a href="#sql39-è·å–employeesä¸­çš„first-name-æŸ¥è¯¢æŒ‰ç…§first-nameæœ€åä¸¤ä¸ªå­—æ¯-æŒ‰ç…§å‡åºè¿›è¡Œæ’åˆ—" class="header-anchor">#</a> SQL39. è·å–Employeesä¸­çš„first_nameï¼ŒæŸ¥è¯¢æŒ‰ç…§first_nameæœ€åä¸¤ä¸ªå­—æ¯ï¼ŒæŒ‰ç…§å‡åºè¿›è¡Œæ’åˆ—</h4> <p><a href="https://www.nowcoder.com/practice/74d90728827e44e2864cce8b26882105?tpId=82&amp;tqId=29820&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> first_name 
<span class="token keyword">FROM</span> employees
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> SUBSTR<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql40-æŒ‰ç…§dept-noè¿›è¡Œæ±‡æ€»-å±äºåŒä¸€ä¸ªéƒ¨é—¨çš„emp-noæŒ‰ç…§é€—å·è¿›è¡Œè¿æ¥-ç»“æœç»™å‡ºdept-noä»¥åŠè¿æ¥å‡ºçš„ç»“æœemployees"><a href="#sql40-æŒ‰ç…§dept-noè¿›è¡Œæ±‡æ€»-å±äºåŒä¸€ä¸ªéƒ¨é—¨çš„emp-noæŒ‰ç…§é€—å·è¿›è¡Œè¿æ¥-ç»“æœç»™å‡ºdept-noä»¥åŠè¿æ¥å‡ºçš„ç»“æœemployees" class="header-anchor">#</a> SQL40. æŒ‰ç…§dept_noè¿›è¡Œæ±‡æ€»ï¼Œå±äºåŒä¸€ä¸ªéƒ¨é—¨çš„emp_noæŒ‰ç…§é€—å·è¿›è¡Œè¿æ¥ï¼Œç»“æœç»™å‡ºdept_noä»¥åŠè¿æ¥å‡ºçš„ç»“æœemployees</h4> <p><a href="https://www.nowcoder.com/practice/6e86365af15e49d8abe2c3d4b5126e87?tpId=82&amp;tqId=29821&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> dept_no<span class="token punctuation">,</span> GROUP_CONCAT<span class="token punctuation">(</span>emp_no<span class="token punctuation">)</span> <span class="token keyword">as</span> employees
<span class="token keyword">FROM</span> dept_emp
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> dept_no<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql41-æŸ¥æ‰¾æ’é™¤å½“å‰æœ€å¤§ã€æœ€å°salaryä¹‹åçš„å‘˜å·¥çš„å¹³å‡å·¥èµ„avg-salary"><a href="#sql41-æŸ¥æ‰¾æ’é™¤å½“å‰æœ€å¤§ã€æœ€å°salaryä¹‹åçš„å‘˜å·¥çš„å¹³å‡å·¥èµ„avg-salary" class="header-anchor">#</a> SQL41. æŸ¥æ‰¾æ’é™¤å½“å‰æœ€å¤§ã€æœ€å°salaryä¹‹åçš„å‘˜å·¥çš„å¹³å‡å·¥èµ„avg_salary</h4> <p><a href="https://www.nowcoder.com/practice/95078e5e1fba4438b85d9f11240bc591?tpId=82&amp;tqId=29822&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>salary <span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_salary
<span class="token keyword">FROM</span> salaries
<span class="token keyword">WHERE</span> to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span> 
<span class="token operator">AND</span> salary <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> salaries <span class="token keyword">WHERE</span> to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span><span class="token punctuation">)</span>
<span class="token operator">AND</span> salary <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> salaries <span class="token keyword">WHERE</span> to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="sql42-åˆ†é¡µæŸ¥è¯¢employeesè¡¨-æ¯5è¡Œä¸€é¡µ-è¿”å›ç¬¬2é¡µçš„æ•°æ®"><a href="#sql42-åˆ†é¡µæŸ¥è¯¢employeesè¡¨-æ¯5è¡Œä¸€é¡µ-è¿”å›ç¬¬2é¡µçš„æ•°æ®" class="header-anchor">#</a> SQL42. åˆ†é¡µæŸ¥è¯¢employeesè¡¨ï¼Œæ¯5è¡Œä¸€é¡µï¼Œè¿”å›ç¬¬2é¡µçš„æ•°æ®</h4> <p><a href="https://www.nowcoder.com/practice/f24966e0cb8a49c192b5e65339bc8c03?tpId=82&amp;tqId=29823&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> employees
<span class="token keyword">LIMIT</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="sql43-ä½¿ç”¨å«æœ‰å…³é”®å­—existsæŸ¥æ‰¾æœªåˆ†é…å…·ä½“éƒ¨é—¨çš„å‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯"><a href="#sql43-ä½¿ç”¨å«æœ‰å…³é”®å­—existsæŸ¥æ‰¾æœªåˆ†é…å…·ä½“éƒ¨é—¨çš„å‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯" class="header-anchor">#</a> SQL43. ä½¿ç”¨å«æœ‰å…³é”®å­—existsæŸ¥æ‰¾æœªåˆ†é…å…·ä½“éƒ¨é—¨çš„å‘˜å·¥çš„æ‰€æœ‰ä¿¡æ¯</h4> <p><a href="https://www.nowcoder.com/practice/c39cbfbd111a4d92b221acec1c7c1484?tpId=82&amp;tqId=29825&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">FROM</span> employees <span class="token keyword">AS</span> e
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>emp_no <span class="token keyword">FROM</span> dept_emp <span class="token keyword">AS</span> d
    <span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> d<span class="token punctuation">.</span>emp_no
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="sql44-åˆ·é¢˜é€šè¿‡çš„é¢˜ç›®æ’å"><a href="#sql44-åˆ·é¢˜é€šè¿‡çš„é¢˜ç›®æ’å" class="header-anchor">#</a> SQL44. åˆ·é¢˜é€šè¿‡çš„é¢˜ç›®æ’å</h4> <p><a href="https://www.nowcoder.com/practice/cd2e10a588dc4c1db0407d0bf63394f3?tpId=82&amp;tqId=35080&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span> DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> number <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t_rank
<span class="token keyword">FROM</span> passing_number
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t_rank<span class="token punctuation">,</span> id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="sql45-è€ƒè¯•åˆ†æ•°-äºŒ"><a href="#sql45-è€ƒè¯•åˆ†æ•°-äºŒ" class="header-anchor">#</a> SQL45. è€ƒè¯•åˆ†æ•°(äºŒ)</h4> <p><a href="https://www.nowcoder.com/practice/f456dedf88a64f169aadd648491a27c1?tpId=82&amp;tqId=35493&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> g1<span class="token punctuation">.</span><span class="token operator">*</span> 
<span class="token keyword">FROM</span> grade <span class="token keyword">AS</span> g1
<span class="token keyword">WHERE</span> score <span class="token operator">&gt;</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> grade <span class="token keyword">AS</span> g2
    <span class="token keyword">WHERE</span> g1<span class="token punctuation">.</span>job <span class="token operator">=</span> g2<span class="token punctuation">.</span>job
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> job
<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> g1<span class="token punctuation">.</span>id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="ğŸ˜…-å›°éš¾"><a href="#ğŸ˜…-å›°éš¾" class="header-anchor">#</a> ğŸ˜…[å›°éš¾]</h3> <h4 id="sql46-æŸ¥æ‰¾å½“å‰è–ªæ°´æ’åç¬¬äºŒå¤šçš„å‘˜å·¥ç¼–å·emp-no"><a href="#sql46-æŸ¥æ‰¾å½“å‰è–ªæ°´æ’åç¬¬äºŒå¤šçš„å‘˜å·¥ç¼–å·emp-no" class="header-anchor">#</a> SQL46. æŸ¥æ‰¾å½“å‰è–ªæ°´æ’åç¬¬äºŒå¤šçš„å‘˜å·¥ç¼–å·emp_no</h4> <p><a href="https://www.nowcoder.com/practice/c1472daba75d4635b7f8540b837cc719?tpId=82&amp;tqId=29770&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>emp_no<span class="token punctuation">,</span> s<span class="token punctuation">.</span>salary<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>first_name
<span class="token keyword">FROM</span> employees <span class="token keyword">AS</span> e
<span class="token keyword">JOIN</span> salaries <span class="token keyword">as</span> s
<span class="token keyword">ON</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> s<span class="token punctuation">.</span>emp_no
<span class="token keyword">WHERE</span> salary <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
    <span class="token keyword">FROM</span> salaries
    <span class="token keyword">WHERE</span> salary <span class="token operator">&lt;</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
        <span class="token keyword">FROM</span> salaries
<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="sql497-å¯¹æ‰€æœ‰å‘˜å·¥çš„å½“å‰è–ªæ°´æŒ‰ç…§salaryè¿›è¡ŒæŒ‰ç…§1-nçš„æ’å"><a href="#sql497-å¯¹æ‰€æœ‰å‘˜å·¥çš„å½“å‰è–ªæ°´æŒ‰ç…§salaryè¿›è¡ŒæŒ‰ç…§1-nçš„æ’å" class="header-anchor">#</a> SQL497. å¯¹æ‰€æœ‰å‘˜å·¥çš„å½“å‰è–ªæ°´æŒ‰ç…§salaryè¿›è¡ŒæŒ‰ç…§1-Nçš„æ’å</h4> <p><a href="https://www.nowcoder.com/practice/b9068bfe5df74276bd015b9729eec4bf?tpId=82&amp;tqId=29775&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_no<span class="token punctuation">,</span> salary<span class="token punctuation">,</span> DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> salary <span class="token keyword">DESC</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t_rank
<span class="token keyword">FROM</span> salaries
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t_rank<span class="token punctuation">,</span> emp_no<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="sql48-è·å–æ‰€æœ‰émanagerå‘˜å·¥å½“å‰çš„è–ªæ°´æƒ…å†µ"><a href="#sql48-è·å–æ‰€æœ‰émanagerå‘˜å·¥å½“å‰çš„è–ªæ°´æƒ…å†µ" class="header-anchor">#</a> SQL48. è·å–æ‰€æœ‰émanagerå‘˜å·¥å½“å‰çš„è–ªæ°´æƒ…å†µ</h4> <p><a href="https://www.nowcoder.com/practice/8fe212a6c71b42de9c15c56ce354bebe?tpId=82&amp;tqId=29776&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> m<span class="token punctuation">.</span>dept_no<span class="token punctuation">,</span> s<span class="token punctuation">.</span>emp_no<span class="token punctuation">,</span> s<span class="token punctuation">.</span>salary
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span> dept_emp de<span class="token punctuation">,</span> dept_manager m<span class="token punctuation">,</span> salaries s
<span class="token keyword">WHERE</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> de<span class="token punctuation">.</span>emp_no
<span class="token operator">AND</span> de<span class="token punctuation">.</span>dept_no <span class="token operator">=</span> m<span class="token punctuation">.</span>dept_no
<span class="token operator">AND</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> s<span class="token punctuation">.</span>emp_no
<span class="token operator">AND</span> e<span class="token punctuation">.</span>emp_no <span class="token operator">!=</span> m<span class="token punctuation">.</span>emp_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="sql49-æŸ¥æ‰¾æè¿°ä¿¡æ¯ä¸­åŒ…æ‹¬robotçš„ç”µå½±å¯¹åº”çš„åˆ†ç±»åç§°ä»¥åŠç”µå½±æ•°ç›®"><a href="#sql49-æŸ¥æ‰¾æè¿°ä¿¡æ¯ä¸­åŒ…æ‹¬robotçš„ç”µå½±å¯¹åº”çš„åˆ†ç±»åç§°ä»¥åŠç”µå½±æ•°ç›®" class="header-anchor">#</a> SQL49. æŸ¥æ‰¾æè¿°ä¿¡æ¯ä¸­åŒ…æ‹¬robotçš„ç”µå½±å¯¹åº”çš„åˆ†ç±»åç§°ä»¥åŠç”µå½±æ•°ç›®</h4> <p><a href="https://www.nowcoder.com/practice/3a303a39cc40489b99a7e1867e6507c5?tpId=82&amp;tqId=29780&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> c<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>film_id<span class="token punctuation">)</span> <span class="token keyword">AS</span> count
<span class="token keyword">FROM</span> film f<span class="token punctuation">,</span> category c<span class="token punctuation">,</span> film_category fc
<span class="token keyword">WHERE</span> f<span class="token punctuation">.</span>film_id <span class="token operator">=</span> fc<span class="token punctuation">.</span>film_id
<span class="token operator">AND</span> fc<span class="token punctuation">.</span>category_id <span class="token operator">=</span> c<span class="token punctuation">.</span>category_id
<span class="token operator">AND</span> f<span class="token punctuation">.</span>description <span class="token operator">LIKE</span> <span class="token string">'%robot%'</span>
<span class="token operator">AND</span> c<span class="token punctuation">.</span>category_id <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> category_id
    <span class="token keyword">FROM</span> film_category
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> category_id
    <span class="token keyword">HAVING</span> <span class="token function">count</span><span class="token punctuation">(</span>category_id<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="sql50-è·å–æœ‰å¥–é‡‘çš„å‘˜å·¥ç›¸å…³ä¿¡æ¯ã€‚"><a href="#sql50-è·å–æœ‰å¥–é‡‘çš„å‘˜å·¥ç›¸å…³ä¿¡æ¯ã€‚" class="header-anchor">#</a> SQL50. è·å–æœ‰å¥–é‡‘çš„å‘˜å·¥ç›¸å…³ä¿¡æ¯ã€‚</h4> <p><a href="https://www.nowcoder.com/practice/5cdbf1dcbe8d4c689020b6b2743820bf?tpId=82&amp;tqId=29827&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> e<span class="token punctuation">.</span>emp_no<span class="token punctuation">,</span> e<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> b<span class="token punctuation">.</span>btype<span class="token punctuation">,</span> s<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">CASE</span> b<span class="token punctuation">.</span>btype
 <span class="token keyword">WHEN</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token number">0.1</span> <span class="token operator">*</span> salary
 <span class="token keyword">WHEN</span> <span class="token number">2</span> <span class="token keyword">THEN</span> <span class="token number">0.2</span> <span class="token operator">*</span> salary
 <span class="token keyword">ELSE</span> <span class="token number">0.3</span> <span class="token operator">*</span> salary
 <span class="token keyword">END</span>
<span class="token punctuation">)</span> bouns
<span class="token keyword">FROM</span> employees e<span class="token punctuation">,</span> emp_bonus b<span class="token punctuation">,</span> salaries s
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> e<span class="token punctuation">.</span>emp_no
<span class="token operator">AND</span> b<span class="token punctuation">.</span>emp_no <span class="token operator">=</span> e<span class="token punctuation">.</span>emp_no
<span class="token operator">AND</span> s<span class="token punctuation">.</span>to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="sql51-ç»Ÿè®¡salaryçš„ç´¯è®¡å’Œrunning-total"><a href="#sql51-ç»Ÿè®¡salaryçš„ç´¯è®¡å’Œrunning-total" class="header-anchor">#</a> SQL51. ç»Ÿè®¡salaryçš„ç´¯è®¡å’Œrunning_total</h4> <p><a href="https://www.nowcoder.com/practice/58824cd644ea47d7b2b670c506a159a6?tpId=82&amp;tqId=29828&amp;rp=1&amp;ru=%2Fta%2Fsql&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey" target="_blank" rel="noopener noreferrer">é“¾æ¥<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> emp_no<span class="token punctuation">,</span> salary<span class="token punctuation">,</span>
<span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> emp_no<span class="token punctuation">)</span> <span class="token keyword">AS</span> running_total
<span class="token keyword">FROM</span> salaries
<span class="token keyword">WHERE</span> to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> s1<span class="token punctuation">.</span>emp_no<span class="token punctuation">,</span> s1<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>
<span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span> <span class="token keyword">FROM</span> salaries s2
    <span class="token keyword">WHERE</span> s2<span class="token punctuation">.</span>emp_no <span class="token operator">&lt;=</span> s1<span class="token punctuation">.</span>emp_no
    <span class="token operator">AND</span> s2<span class="token punctuation">.</span>to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span>
<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> salaries s1
<span class="token keyword">WHERE</span> s1<span class="token punctuation">.</span>to_date <span class="token operator">=</span> <span class="token string">'9999-01-01'</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> s1<span class="token punctuation">.</span>emp_no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/lemoba/lemoba.github.io/edit/main/docs/mysql/2-SQL-exercise.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/6/2022, 9:41:59 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.d008bd4a.js" defer></script><script src="/assets/js/2.c3ba2a3e.js" defer></script><script src="/assets/js/31.602c3c3b.js" defer></script>
  </body>
</html>

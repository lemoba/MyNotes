(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{460:function(s,t,n){"use strict";n.r(t);var a=n(11),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"docker的网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker的网络"}},[s._v("#")]),s._v(" docker的网络")]),s._v(" "),n("h2",{attrs:{id:"_1-端口转发"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-端口转发"}},[s._v("#")]),s._v(" 1. 端口转发")]),s._v(" "),n("blockquote",[n("p",[s._v("-p [PORT1]:[PORT2] --PORT1: 本地端口 --PORT2: 容器内端口")])]),s._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://mynotes-1252832980.cos.ap-shanghai.myqcloud.com/image-20220318135734323.png"}}),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container run -d --rm --name web -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":80 nginx-alpine:v.1.0\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container inspect --format "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{{.NetworkSettings.IPAddress}}'")]),s._v(" web\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#172.17.0.3")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container run -d --rm --name client busybox /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it client "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://172.17.0.3\n\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" iptables -t nat -nvxL\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如下图所示")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://mynotes-1252832980.cos.ap-shanghai.myqcloud.com/image-20220318141333226.png"}}),s._v(" "),n("h2",{attrs:{id:"_2-常见网络命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-常见网络命令"}},[s._v("#")]),s._v(" 2. 常见网络命令")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("ifconfig | ip addr")])]),s._v(" "),n("li",[n("p",[s._v("ping")])]),s._v(" "),n("li",[n("p",[s._v("telnet：测试端口的连通性")])]),s._v(" "),n("li",[n("p",[s._v("tracepath：路径探测跟踪")])]),s._v(" "),n("li",[n("p",[s._v("curl： "),n("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2019/09/curl-reference.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("请求web服务"),n("OutboundLink")],1)])])]),s._v(" "),n("h2",{attrs:{id:"_3-网桥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-网桥"}},[s._v("#")]),s._v(" 3. 网桥")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://mynotes-1252832980.cos.ap-shanghai.myqcloud.com/image-20220318150548920.png"}})]),s._v(" "),n("th",[n("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://mynotes-1252832980.cos.ap-shanghai.myqcloud.com/image-20220318150400457.png"}})])])]),s._v(" "),n("tbody")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 查看网桥")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n\ndocker0: "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flags")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("416")]),n("span",{pre:!0,attrs:{class:"token operator"}},[n("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("UP,BROADCAST,RUNNING,MULTICAST"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("\n        inet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.1  netmask "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".0.0  broadcast "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255\n        inet6 fe80::42:91ff:fe42:c15e  prefixlen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("  scopeid 0x2"),n("span",{pre:!0,attrs:{class:"token operator"}},[n("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v("<")]),s._v("link"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        ether 02:42:91:42:c1:5e  txqueuelen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ethernet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX packets "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27233")]),s._v("  bytes "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2141194")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(" MiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX errors "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        TX packets "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("27279")]),s._v("  bytes "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("48324171")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("46.0")]),s._v(" MiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        TX errors "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 列出网络")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n\nNETWORK ID     NAME      DRIVER    SCOPE\n33618a38984a   bridge    bridge    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n381f2cfd273d   "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nbf8f85b3153d   none      null      "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y bridge-utils\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3 显示bridge")]),s._v("\nbrctl show\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4 路由表")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" route\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h3",{attrs:{id:"_3-1-容器对外通信"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-容器对外通信"}},[s._v("#")]),s._v(" 3.1 容器对外通信")]),s._v(" "),n("ul",[n("li",[s._v("查看路由 ip")])]),s._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://mynotes-1252832980.cos.ap-shanghai.myqcloud.com/image-20220318151122562.png"}}),s._v(" "),n("ul",[n("li",[s._v("iptable 转发规则")])]),s._v(" "),n("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://mynotes-1252832980.cos.ap-shanghai.myqcloud.com/image-20220318151244345.png"}}),s._v(" "),n("ul",[n("li",[n("p",[s._v("NAT转换")]),s._v(" "),n("blockquote",[n("p",[s._v("在公有地址和私有地址之间进行转换")])])])]),s._v(" "),n("h3",{attrs:{id:"_3-2-bridge网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-bridge网络"}},[s._v("#")]),s._v(" 3.2 bridge网络")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1 创建网络")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create -d bridge mybridge\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2 --network [BRIDGENAME] 指定网络")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container run -d --rm --name client3 --network mybridge busybox /bin/sh -c "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3 指定容器连接的网络")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network connect "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("BRIDGE_NAME"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("CONTAINER_NAME"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker network connect bridge client3")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4 删除容器连接的网络")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network disconnect "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("BRIDGE_NAME"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("CONTAINER_NAME"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"_3-3-host网络"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-host网络"}},[s._v("#")]),s._v(" 3.3 host网络")]),s._v(" "),n("blockquote",[n("p",[s._v("和宿主机共享同一网络")])]),s._v(" "),n("h2",{attrs:{id:"_4-网络命名空间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-网络命名空间"}},[s._v("#")]),s._v(" 4. 网络命名空间")]),s._v(" "),n("blockquote",[n("p",[s._v("linux的Namespace是一种隔离技术")])]),s._v(" "),n("p",[n("strong",[s._v("Namepace")])]),s._v(" "),n("ul",[n("li",[s._v("user namespace")]),s._v(" "),n("li",[s._v("process namespace")]),s._v(" "),n("li",[s._v("network namespace")])])])}),[],!1,null,null,null);t.default=e.exports}}]);